<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BSH's Travel</title>
  <link rel="icon" href="../image/favicon.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="../css/travel_map.css">
</head>
<body>

  <div class="sidebar" id="sidebar">
    <a href="/bsh_travel/main" title="메인으로 이동">
      <img src="../image/travel_logo.png" alt="BSH Travel Logo" class="logo" />
    </a>
    <div class="country-list" id="countryList"></div>
    <button id="toggleBtn" title="사이드바 닫기">🡄</button>
    <div class="description" id="description"></div>
    <button id="showCountryListBtn" class="title-btn hidden">← 나라 목록 보기</button>
  </div>
  <button id="openBtn" title="사이드바 열기">☰</button>

  <div class="mobile-controls" id="mobileControls">
    <div class="country-slider-container">
      <div id="country-slider" class="country-slider"></div>
    </div>
    <div id="info-panel" class="info-panel">
      <button id="back-button" class="back-button hidden">← 뒤로가기</button>
      <div id="content-list"></div>
    </div>
  </div>
  <button id="mobileToggleBtn">☰</button>
  <a href="/bsh_travel/main" id="mobileHomeBtn" title="메인으로 이동">🏠</a>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
    // 주요 DOM 요소
    const sidebar = document.getElementById("sidebar");
    const description = document.getElementById("description");
    const mapDiv = document.getElementById("map");
    const toggleBtn = document.getElementById("toggleBtn");
    const openBtn = document.getElementById("openBtn");
    const countryListDiv = document.getElementById("countryList");
    const showCountryListBtn = document.getElementById("showCountryListBtn");

    const mobileControls = document.getElementById("mobileControls");
    const countrySlider = document.getElementById("country-slider");
    const infoPanel = document.getElementById("info-panel");
    const contentList = document.getElementById("content-list");
    const backButton = document.getElementById("back-button");
    const mobileToggleBtn = document.getElementById("mobileToggleBtn");
    

    let map, allCityMarkers = [], currentDetailMarkers = [], selectedCityMarker = null, selectedDetailMarker = null, selectedDetailListItem = null;
    let currentView = 'countries'; // 'countries', 'cities', 'details'
    let currentCountry = null;
    let currentCity = null;

    // 공통 데이터 (생략)
    const data = [
    {
        name: "일본",
        cities: [
            {
                name: "🍣 후쿠오카",
                lat: 33.586309,
                lng: 130.376301,
                desc: "가볍게 떠나기 좋은 가까운 여행지",
                sights: [
                	{
                        name: "오호리 공원",
                        lat: 33.586309,
                        lng: 130.376301,
                        imageUrl: "../image/image_japan05/place6-1.jpg"
                    },
                    {
                        name: "츠야타 서점 롯폰마츠",
                        lat: 33.577405,
                        lng: 130.377996,
                        imageUrl: "../image/image_japan05/place7-1.jpg"
                    },
                    {
                        name: "나카스 포장마차거리",
                        lat: 33.59038,
                        lng: 130.40833,
                        imageUrl: "../image/image_sapporo/place13-1.jpg"
                    },
                    {
                        name: "캐널시티",
                        lat: 33.58961,
                        lng: 130.41090,
                        imageUrl: "../image/image_sapporo/place14-1.jpg"
                    },
                    {
                        name: "나미하노유 온천",
                        lat: 33.60389,
                        lng: 130.39814,
                        imageUrl: "../image/image_sapporo/place15-1.jpg"
                    },
                    {
                        name: "야나가와 뱃놀이",
                        lat: 33.16721,
                        lng: 130.41541,
                        imageUrl: "../image/image_sapporo/place16-1.jpg"
                    },
                    {
                        name: "라라포트",
                        lat: 33.56525,
                        lng: 130.44127,
                        imageUrl: "../image/image_sapporo/place17-1.jpg"
                    }
                ],
                foods: [
                    {
                        name: "一蘭 本社総本店 - 이치란 라멘 본점",
                        lat: 33.593222,
                        lng: 130.404563,
                        imageUrl: "../image/image_japan05/food3-3.jpg"
                    },
                    {
                        name: "博多もつ鍋 朋樂 - 모츠나베",
                        lat: 33.588822,
                        lng: 130.421579,
                        imageUrl: "../image/image_japan05/food5-6.jpg"
                    }
                ]
            },
            {
                name: "🍣 시모노세키",
                lat: 33.9565664,
                lng: 130.9456336,
                desc: "바닷바람 맞으며 쉬기 좋은 힐링 여행지",
                sights: [
                    {
                        name: "가라토시장",
                        lat: 33.9565664,
                        lng: 130.9456336,
                        imageUrl: "../image/image_japan/place1-4.jpg"
                    },
                    {
                        name: "모지코",
                        lat: 33.9463622,
                        lng: 130.9586796,
                        imageUrl: "../image/image_japan/place2-4.jpg"
                    },
                    {
                        name: "아카미신궁",
                        lat: 33.959165,
                        lng: 130.948917,
                        imageUrl: "../image/image_japan/place3-1.jpg"
                    },
                    {
                        name: "영국영사관",
                        lat: 33.9569074,
                        lng: 130.9430147,
                        imageUrl: "../image/image_japan05/place1-1.jpg"
                    },
                    {
                        name: "카랏토요코쵸",
                        lat: 33.953191,
                        lng: 130.941130,
                        imageUrl: "../image/image_japan05/place4-1.jpg"
                    }
                ],
                foods: [
                    {
                    	name: "たいむ亭 - 돈까스",
                        lat: 33.944987,
                        lng: 130.960499,
                        imageUrl: "../image/image_japan/food8-1.jpg"
                    }
                ]
            },
            {
                name: "🍣 유후인",
                lat: 33.266662,
                lng: 131.368931,
                desc: "일본 시골 감성 가득한 여행지",
                sights: [
                    {
                        name: "킨린 호수",
                        lat: 33.266662,
                        lng: 131.368931,
                        imageUrl: "../image/image_japan/place3-1.jpg"
                    }
                ],
                foods: [
                    {
                        name: "ゆるりん - 연어까스",
                        lat: 33.2627319,
                        lng: 131.3553187,
                        imageUrl: "../image/image_japan/food3-1.jpg"
                    },
                    {
                        name: "B.Bee's - 벌꿀 아이스크림",
                        lat: 33.266318,
                        lng: 131.3621605,
                        imageUrl: "../image/image_japan/food4-3.jpg"
                    },
                    {
                        name: "湯布院金賞コロッケ - 고로켓",
                        lat: 33.266494,
                        lng: 131.362538,
                        imageUrl: "../image/image_japan/food5-1.jpg"
                    }
                ]
            },
            {
                name: "🍣 이토시마",
                lat: 33.639210,
                lng: 130.197161,
                desc: "바다와 함께하는 고즈넉한 운치",
                sights: [
                    {
                        name: "사쿠라이 후타미가우라",
                        lat: 33.639210,
                        lng: 130.197161,
                        imageUrl: "../image/image_japan05/place8-1.jpg"
                    }
                ],
                foods: [
                    {
                        name: "糸島茶房 - 핫케이크",
                        lat: 33.640486,
                        lng: 130.200039,
                        imageUrl: "../image/image_japan05/food4-4.jpg"
                    }
                ]
            },
            
            {
                name: "🍣 오사카",
                lat: 34.66891,
                lng: 135.50108,
                desc: "보고, 먹고, 즐길 게 많은 여행지.",
                sights: [
                    {
                        name: "글리코상",
                        lat: 34.66891,
                        lng: 135.50108,
                        imageUrl: "../image/image_japan08/place1-3.jpg"
                    },
                    {
                        name: "Universal Studios Japan",
                        lat: 34.665509,
                        lng: 135.4327,
                        imageUrl: "../image/image_japan08/place4-1.jpg"
                    },
                    {
                        name: "카이유칸 수족관",
                        lat: 34.65445,
                        lng: 135.42890,
                        imageUrl: "../image/image_japan08/place5-1.jpg"
                    },
                    {
                        name: "오렌지 스트리트",
                        lat: 34.67135,
                        lng: 135.48849,
                        imageUrl: "../image/image_japan08/place8-1.jpg"
                    },
                    {
                        name: "잔카라",
                        lat: 34.67240,
                        lng: 135.49788,
                        imageUrl: "../image/image_japan08/place9-1.jpg"
                    },
                    {
                        name: "덴덴타운",
                        lat: 34.66042,
                        lng: 135.50588,
                        imageUrl: "../image/image_japan08/place10-2.jpg"
                    },
                    {
                        name: "우메다 스카이빌딩",
                        lat: 34.70516,
                        lng: 135.48973,
                        imageUrl: "../image/image_japan08/place11-4.jpg"
                    }
                ],
                foods: [
                    {
                    	name: "真っ赤ならーめん - 토마토 라멘",
                        lat: 34.69913,
                        lng: 135.49955,
                        imageUrl: "../image/image_japan08/food1-4.jpg"
                    },
                    {
                    	name: "金龍ラーメン - 킨류라멘",
                        lat: 34.66866,
                        lng: 135.50305,
                        imageUrl: "../image/image_japan08/food2-1.jpg"
                    },
                    {
                    	name: "九州らーめん亀王 - 규슈라멘",
                        lat: 34.66863,
                        lng: 135.49944,
                        imageUrl: "../image/image_japan08/food19-5.jpg"
                    },
                    {
                    	name: "だるま 道頓堀店 - 쿠시카츠",
                        lat: 34.66884,
                        lng: 135.50259,
                        imageUrl: "../image/image_japan08/food3-1.jpg"
                    },
                    {
                    	name: "元祖アイスドッグ - 아이스도그",
                        lat: 34.47228,
                        lng: 135.49809,
                        imageUrl: "../image/image_japan08/food13-1.jpg"
                    },
                    {
                    	name: "かに道楽 道頓堀 東店 - 가니도라쿠",
                        lat: 34.66886,
                        lng: 135.50593,
                        imageUrl: "../image/image_japan08/food8-1.jpg"
                    },
                    {
                    	name: "釣船茶屋ざうお難波本店 - 자우오",
                        lat: 34.66834,
                        lng: 135.50672,
                        imageUrl: "../image/image_japan08/food10-5.jpg"
                    },
                    {
                    	name: "スシロー 難波アムザ店 - 초밥",
                        lat: 34.666600,
                        lng: 135.503543,
                        imageUrl: "../image/image_japan08/food10-5.jpg"
                    }
                ]
            },
            {
                name: "🍣 교토",
                lat: 34.99464,
                lng: 135.78466,
                desc: "정통 감성이 묻어나는 곳",
                sights: [
                    {
                        name: "기요미즈데라",
                        lat: 34.99464,
                        lng: 135.78466,
                        imageUrl: "../image/image_japan08/place7-8.jpg"
                    }
                ],
                foods: [
                    {
                    	name: "京都貴船 料理旅館 ひろ文 - 나가시소멘",
                        lat: 35.12525,
                        lng: 135.76397,
                        imageUrl: "../image/image_japan08/food9-4.jpg"
                    }
                ]
            },
            {
                name: "🍣 나라",
                lat: 34.684826,
                lng: 135.84302,
                desc: "사슴이 반겨주는 여행지",
                sights: [
                    {
                        name: "나라 공원",
                        lat: 34.684826,
                        lng: 135.84302,
                        imageUrl: "../image/image_japan08/place3-1.jpg"
                    },
                    {
                        name: "나라 축제",
                        lat: 34.68689,
                        lng: 135.79415,
                        imageUrl: "../image/image_japan08/place6-3.jpg"
                    }
                ],
                foods: [
                	{
                    	name: "餃子の王将 心斎橋店 - 교자",
                        lat: 34.67347,
                        lng: 135.50168,
                        imageUrl: "../image/image_japan08/food4-1.jpg"
                    }
                ]
            },
            {
                name: "🍣 고베",
                lat: 34.57502,
                lng: 135.00066,
                desc: "고요하지만 세련된 도시의 결",
                sights: [
                    {
                        name: "니지겐노모리",
                        lat: 34.57502,
                        lng: 135.00066,
                        imageUrl: "../image/image_japan08/place12-7.jpg"
                    },
                    {
                        name: "하버랜드",
                        lat: 34.68008,
                        lng: 135.18352,
                        imageUrl: "../image/image_japan08/place13-7.jpg"
                    },
                    {
                        name: "난킨마치",
                        lat: 34.68821,
                        lng: 135.18811,
                        imageUrl: "../image/image_japan08/place13-11.jpg"
                    }
                ],
                foods: [
                	{
                        name: "京屋元町本店 - 우동",
                        lat: 34.68870,
                        lng: 135.18814,
                        imageUrl: "../image/image_japan08/food21-1.jpg"
                    }
                ]
            },
            {
                name: "🍣 삿포로",
                lat: 43.06077,
                lng: 141.35438,
                desc: "눈의 도시, 삿포로",
                sights: [
                	{
                        name: "오도리공원",
                        lat: 43.06077,
                        lng: 141.35438,
                        imageUrl: "../image/image_sapporo/place1-1.jpg"
                    },
                    {
                        name: "비에이역",
                        lat: 43.59110,
                        lng: 142.46174,
                        imageUrl: "../image/image_sapporo/place2-1.jpg"
                    },
                    {
                        name: "흰수염 폭포",
                        lat: 43.47522,
                        lng: 142.63875,
                        imageUrl: "../image/image_sapporo/place3-1.jpg"
                    },
                    {
                        name: "시카리베츠 호수",
                        lat: 43.27565,
                        lng: 143.11473,
                        imageUrl: "../image/image_sapporo/place4-1.jpg"
                    }
                ],
                foods: [
                ]
            },
            {
                name: "🍣 도쿄",
                lat: 35.69306,
                lng: 139.69959,
                desc: "일본 특유의 도시 감성을 느낄 수 있는 곳",
                sights: [
                	{
                        name: "오모이데요코초",
                        lat: 35.69306,
                        lng: 139.69959,
                        imageUrl: "../image/image_sapporo/place5-1.jpg"
                    },
                    {
                        name: "스크램블 스퀘어",
                        lat: 35.65850,
                        lng: 139.70220,
                        imageUrl: "../image/image_sapporo/place18-1.jpg"
                    },
                    {
                        name: "도쿄 타워",
                        lat: 35.65855,
                        lng: 139.74538,
                        imageUrl: "../image/image_sapporo/place6-1.jpg"
                    },
                    {
                        name: "후지산",
                        lat: 35.36293,
                        lng: 138.72307,
                        imageUrl: "../image/image_sapporo/place7-1.jpg"
                    },
                    {
                        name: "너의이름은",
                        lat: 35.68516,
                        lng: 139.72338,
                        imageUrl: "../image/image_sapporo/place8-1.jpg"
                    },
                    {
                        name: "나카미세도리",
                        lat: 35.71189,
                        lng: 139.79644,
                        imageUrl: "../image/image_sapporo/place12-2.jpg"
                    }
                ],
                foods: [
                   
                ]
            },
            {
                name: "🍣 히타카츠",
                lat: 34.666708,
                lng: 129.484499,
                desc: "가까워서 부담 없이 즐기는 여행지",
                sights: [
                	{
                        name: "미우다 해변",
                        lat: 34.666708,
                        lng: 129.484499,
                        imageUrl: "../image/image_daemado/place1-1.jpg"
                    },
                    {
                        name: "나기사노유 온천",
                        lat: 34.66979,
                        lng: 129.48396,
                        imageUrl: "../image/image_daemado/place2-1.jpg"
                    },
                    {
                        name: "곤겐산 전망대",
                        lat: 34.66262,
                        lng: 129.47974,
                        imageUrl: "../image/image_daemado/place3-1.jpg"
                    }
                ],
                foods: [
                    {
                    	name: "マルフク ラーメン",
                        lat: 34.65536,
                        lng: 129.46535,
                        imageUrl: "../image/image_daemado/food1-4.jpg"
                    },
                    {
                    	name: "島めし家 北斗 (호쿠토)",
                        lat: 34.65883,
                        lng: 129.47040,
                        imageUrl: "../image/image_daemado/food2-2.jpg"
                    },
                    {
                    	name: "かいかん食堂",
                        lat: 34.65559,
                        lng: 129.46627,
                        imageUrl: "../image/image_daemado/food3-1.jpg"
                    },
                    {
                    	name: "対馬久兵衛商店",
                        lat: 34.65526,
                        lng: 129.46623,
                        imageUrl: "../image/image_daemado/food5-1.jpg"
                    }
                ]
            },
            {
                name: "🍣 이즈하라",
                lat: 34.20421,
                lng: 129.28556,
                desc: "작지만 매력적인 일본 소도시",
                sights: [
                    {
                        name: "이사리비공원",
                        lat: 34.20564,
                        lng: 129.29752,
                        imageUrl: "../image/image_damado2/place1-1.jpg"
                    },
                    {
                        name: "가네이시 성 터",
                        lat: 34.20421,
                        lng: 129.28556,
                        imageUrl: "../image/image_damado2/place2-1.jpg"
                    },
                    {
                        name: "덕혜옹주 기념비",
                        lat: 34.20382,
                        lng: 129.28614,
                        imageUrl: "../image/image_damado2/place3-1.jpg"
                    },
                    {
                        name: "반쇼인",
                        lat: 34.20429,
                        lng: 129.28405,
                        imageUrl: "../image/image_damado2/place4-1.jpg"
                    },
                    {
                        name: "조선통신사역사관",
                        lat: 34.20355,
                        lng: 129.28594,
                        imageUrl: "../image/image_damado2/place5-1.jpg"
                    },
                    {
                        name: "유타리랜드",
                        lat: 34.28499,
                        lng: 129.31883,
                        imageUrl: "../image/image_damado2/place6-1.jpg"
                    }
                ],
                foods: [
                    {
                    	name: "うどん茶屋",
                        lat: 34.22982,
                        lng: 129.30275,
                        imageUrl: "../image/image_damado2/food1-1.jpg"
                    },
                    {
                    	name: "横浜家系ラーメン 半之助",
                        lat: 34.20245,
                        lng: 129.29134,
                        imageUrl: "../image/image_damado2/food2-1.jpg"
                    }
                ]
            }
        ]
    },
    {
        name: "중국",
        cities: [
            {
                name: "🐼 베이징",
                lat: 39.88224,
                lng: 116.40652,
                desc: "웅장함과 거대함",
                sights: [
                	{
                        name: "天坛公园 - 천단공원",
                        lat: 39.88224,
                        lng: 116.40652,
                        imageUrl: "../image/image_country24/place1-3.jpg"
                    },
                    {
                        name: "王府井大街 - 왕푸징 거리",
                        lat: 39.91592,
                        lng: 116.41117,
                        imageUrl: "../image/image_country24/place2-1.jpg"
                    },
                    {
                        name: "八达岭长城 - 팔달령장성",
                        lat: 40.35946,
                        lng: 115.98704,
                        imageUrl: "../image/image_country24/place3-6.jpg"
                    },
                    {
                        name: "颐和园 - 이화원",
                        lat: 39.99993,
                        lng: 116.27547,
                        imageUrl: "../image/image_country24/place4-3.jpg"
                    },
                    {
                        name: "天安门 - 천안문",
                        lat: 39.90874,
                        lng: 116.39769,
                        imageUrl: "../image/image_country24/place5-3.jpg"
                    },
                    {
                        name: "Universal Beijing Resort",
                        lat: 39.85319,
                        lng: 116.66055,
                        imageUrl: "../image/image_country24/place6-1.jpg"
                    },
                    {
                        name: "紫禁城 - 자금성",
                        lat: 39.91751,
                        lng: 116.39706,
                        imageUrl: "../image/image_country24/place7-3.jpg"
                    },
                    {
                        name: "景山公园 - 경산공원",
                        lat: 39.92505,
                        lng: 116.39668,
                        imageUrl: "../image/image_country24/place8-3.jpg"
                    },
                    {
                        name: "베이징 동물원",
                        lat: 39.93886,
                        lng: 116.33953,
                        imageUrl: "../image/image_country24/place9-2.jpg"
                    },
                    {
                        name: "전문대가",
                        lat: 39.89355,
                        lng: 116.39830,
                        imageUrl: "../image/image_country24/place10-2.jpg"
                    }
                ],
                foods: [
                    {
                    	name: "方砖厂69号炸酱面(王府世纪店)",
                        lat: 39.93821,
                        lng: 116.39774,
                        imageUrl: "../image/image_country24/food1-1.jpg"
                    },
                    {
                    	name: "南城香 - 훠궈",
                        lat: 39.93310,
                        lng: 116.40504,
                        imageUrl: "../image/image_country24/food3-4.jpg"
                    },
                    {
                    	name: "很久以前羊肉串 - 양꼬치",
                        lat: 39.91508,
                        lng: 116.40815,
                        imageUrl: "../image/image_country24/food7-2.jpg"
                    },
                    {
                    	name: "好开心烧饼里脊",
                        lat: 39.92193,
                        lng: 116.40629,
                        imageUrl: "../image/image_country24/food8-3.jpg"
                    },
                    {
                    	name: "外婆家 - 동파육",
                        lat: 39.91542,
                        lng: 116.41182,
                        imageUrl: "../image/image_country24/food10-1.jpg"
                    }
                ]
            },
            {
                name: "🐼 상하이",
                lat: 31.239220,
                lng: 121.479499,
                desc: "화려하고 아름다운 야경",
                sights: [
                	{
                        name: "난징동루",
                        lat: 31.239220,
                        lng: 121.479499,
                        imageUrl: "../image/image_shanghai/place1-1.jpg"
                    },
                    {
                        name: "신천지",
                        lat: 31.21860,
                        lng: 121.47533,
                        imageUrl: "../image/image_shanghai/place2-1.jpg"
                    },
                    {
                        name: "대한민국 임시정부",
                        lat: 31.21730,
                        lng: 121.47464,
                        imageUrl: "../image/image_shanghai/place4-1.jpg"
                    },
                    {
                        name: "티엔즈팡",
                        lat: 31.20882,
                        lng: 121.46888,
                        imageUrl: "../image/image_shanghai/place5-2.jpg"
                    },
                    {
                        name: "예원",
                        lat: 31.22735,
                        lng: 121.49208,
                        imageUrl: "../image/image_shanghai/place6-1.jpg"
                    },
                    {
                        name: "주가각",
                        lat: 31.10410,
                        lng: 121.04568,
                        imageUrl: "../image/image_shanghai/place7-1.jpg"
                    },
                    {
                        name: "마시청 서커스",
                        lat: 31.30651,
                        lng: 121.44789,
                        imageUrl: "../image/image_shanghai/place9-2.jpg"
                    },
                    {
                        name: "와이탄",
                        lat: 31.24016,
                        lng: 121.49057,
                        imageUrl: "../image/image_shanghai/place11-1.jpg"
                    },
                    {
                        name: "동방명주",
                        lat: 31.23971,
                        lng: 121.49977,
                        imageUrl: "../image/image_shanghai/place12-1.jpg"
                    }
                ],
                foods: [
                    {
                        name: "新白鹿",
                        lat: 31.243159,
                        lng: 121.475176,
                        imageUrl: "../image/image_shanghai/food7-1.jpg"
                    },
                    {
                        name: "上海姥姥家常饭馆",
                        lat: 31.23746,
                        lng: 121.48463,
                        imageUrl: "../image/image_shanghai/food8-1.jpg"
                    },
                    {
                        name: "小杨生煎",
                        lat: 31.234697,
                        lng: 121.475269,
                        imageUrl: "../image/image_shanghai/food9-5.jpg"
                    }
                ]
            },
            {
                name: "🐼 광저우",
                lat: 23.10969,
                lng: 113.23937,
                desc: "또 하나의 내 집 같은 곳",
                sights: [
                	{
                        name: "顺峰山公园 - 순봉산공원",
                        lat: 22.83080,
                        lng: 113.27125,
                        imageUrl: "../image/image_chinahome/place1-1.jpg"
                    },
                    {
                        name: "沙面島 - 샤멘다오",
                        lat: 23.10969,
                        lng: 113.23937,
                        imageUrl: "../image/image_chinahome/place2-5.jpg"
                    },
                    {
                        name: "北京路步行街",
                        lat: 23.12730,
                        lng: 113.26361,
                        imageUrl: "../image/image_chinahome/place3-2.jpg"
                    },
                    {
                    	name: "佛山岭南天地",
                        lat: 23.032525,
                        lng: 113.110900,
                        imageUrl: "../image/image_chinahome/place4-1.jpg"
                    },
                    {
                    	name: "广州东出口",
                        lat: 22.67837,
                        lng: 113.59035,
                        imageUrl: "../image/image_chinahome/place5-2.jpg"
                    },
                    {
                    	name: "和美術馆",
                        lat: 22.935606,
                        lng: 113.214701,
                        imageUrl: "../image/image_chinahome/place7-1.jpg"
                    }
                ],
                foods: [
                    {
                    	name: "海底捞火锅",
                        lat: 22.97365,
                        lng: 113.29765,
                        imageUrl: "../image/image_chinahome/food1-1.jpg"
                    }
                ]
            }
        ]
    },
    {
        name: "대만",
        cities: [
            {
                name: "🏮 타이베이",
                lat: 25.04290,
                lng: 121.50577,
                desc: "야시장, 먹거리와 사람들로 가득",
                sights: [
                	{
                        name: "시먼딩",
                        lat: 25.04290,
                        lng: 121.50577,
                        imageUrl: "../image/image_taiwan/place1-1.jpg"
                    },
                    {
                        name: "스린 야시장",
                        lat: 25.08852,
                        lng: 121.52431,
                        imageUrl: "../image/image_taiwan/place2-1.jpg"
                    },
                    {
                        name: "스펀",
                        lat: 25.04110,
                        lng: 121.77506,
                        imageUrl: "../image/image_taiwan/place3-1.jpg"
                    },
                    {
                        name: "지우펀",
                        lat: 25.10910,
                        lng: 121.84627,
                        imageUrl: "../image/image_taiwan/place4-4.jpg"
                    },
                    {
                        name: "닝샤 야시장",
                        lat: 25.05658,
                        lng: 121.51527,
                        imageUrl: "../image/image_taiwan/place5-1.jpg"
                    },
                    {
                        name: "화산1914",
                        lat: 25.04409,
                        lng: 121.52936,
                        imageUrl: "../image/image_taiwan/place6-1.jpg"
                    }
                ],
                foods: [
                    {
                    	name: "阿宗麵線 - 곱창국수",
                        lat: 25.04330,
                        lng: 121.50769,
                        imageUrl: "../image/image_taiwan/food1-2.jpg"
                    },
                    {
                    	name: "幸福堂",
                        lat: 25.04337,
                        lng: 121.50730,
                        imageUrl: "../image/image_taiwan/food2-1.jpg"
                    },
                    {
                    	name: "春水堂",
                        lat: 25.04419,
                        lng: 121.52933,
                        imageUrl: "../image/image_taiwan/food13-1.jpg"
                    }
                ]
            }
        ]
    },
    {
        name: "베트남",
        cities: [
            {
                name: "🌾 하노이",
                lat: 21.03075,
                lng: 105.85242,
                desc: "쌀국수 향이 퍼지는 오래된 골목들",
                sights: [
                	{
                        name: "호암끼엠 호수 & 녹손 사원",
                        lat: 21.03075,
                        lng: 105.85242,
                        imageUrl: "../image/image_vietnam/place1-2.jpg"
                    },
                    {
                        name: "못꼿 사원 & 바딘 광장",
                        lat: 21.03691,
                        lng: 105.83463,
                        imageUrl: "../image/image_vietnam/place6-5.jpg"
                    },
                    {
                        name: "기찻길 카페",
                        lat: 21.03037,
                        lng: 105.84433,
                        imageUrl: "../image/image_vietnam/place7-2.jpg"
                    },
                    {
                        name: "성 요셉 대성당",
                        lat: 21.02877,
                        lng: 105.84886,
                        imageUrl: "../image/image_vietnam/place8-1.jpg"
                    },
                    {
                        name: "탕롱 수상인형극장",
                        lat: 21.03171,
                        lng: 105.85334,
                        imageUrl: "../image/image_vietnam/place9-2.jpg"
                    },
                    {
                        name: "동쑤언 시장",
                        lat: 21.03824,
                        lng: 105.85001,
                        imageUrl: "../image/image_vietnam/place10-1.jpg"
                    }
                ],
                foods: [
                    {
                    	name: "Bếp Việt",
                        lat: 21.03052,
                        lng: 105.85055,
                        imageUrl: "../image/image_vietnam/food1-1.jpg"
                    },
                    {
                    	name: "Ngọt - 케이크",
                        lat: 21.02907,
                        lng: 105.84443,
                        imageUrl: "../image/image_vietnam/food2-2.jpg"
                    },
                    {
                    	name: "Drop In Cafe - 코코넛 커피",
                        lat: 21.03127,
                        lng: 105.84514,
                        imageUrl: "../image/image_vietnam/food13-1.jpg"
                    },
                    {
                    	name: "Bún chả Hương Liên",
                        lat: 21.01809,
                        lng: 105.85393,
                        imageUrl: "../image/image_vietnam/food10-2.jpg"
                    },
                    {
                    	name: "Bun Cha Dac Kim",
                        lat: 21.03229,
                        lng: 105.84822,
                        imageUrl: "../image/image_vietnam/food14-1.jpg"
                    },
                    {
                    	name: "Quan An Ngon - 반쎄오",
                        lat: 21.02637,
                        lng: 105.84334,
                        imageUrl: "../image/image_vietnam/food16-1.jpg"
                    },
                    {
                    	name: "Bánh cuốn Bà Xuân - 반 꾸온",
                        lat: 21.04222,
                        lng: 105.84780,
                        imageUrl: "../image/image_vietnam/food15-1.jpg"
                    }
                ]
            },
            {
                name: "🌾 사파",
                lat: 22.33112,
                lng: 103.83402,
                desc: "자연이 어우러진 힐링 여행지",
                sights: [
                	{
                        name: "깟깟마을",
                        lat: 22.33112,
                        lng: 103.83402,
                        imageUrl: "../image/image_vietnam/place2-1.jpg"
                    },
                    {
                        name: "판시판",
                        lat: 22.30357,
                        lng: 103.77489,
                        imageUrl: "../image/image_vietnam/place3-4.jpg"
                    },
                    {
                        name: "사파 호수",
                        lat: 22.33830,
                        lng: 103.84621,
                        imageUrl: "../image/image_vietnam/place4-1.jpg"
                    },
                    {
                        name: "사파 야시장",
                        lat: 22.33857,
                        lng: 103.85156,
                        imageUrl: "../image/image_vietnam/place5-1.jpg"
                    }
                ],
                foods: [
                	{
                    	name: "Cong Coffee",
                        lat: 22.33626,
                        lng: 103.84306,
                        imageUrl: "../image/image_vietnam/food5-1.jpg"
                    },
                    {
                    	name: "Hotel Sapa Square , Affiliated by Meliá - 양식",
                        lat: 22.33481,
                        lng: 103.84115,
                        imageUrl: "../image/image_vietnam/food6-4.jpg"
                    },
                    {
                    	name: "Good Morning View Restaurant - 코코넛 카레",
                        lat: 22.33010,
                        lng: 103.84592,
                        imageUrl: "../image/image_vietnam/food7-1.jpg"
                    },
                    {
                    	name: "THE MIST SAPA",
                        lat: 22.33562,
                        lng: 103.83820,
                        imageUrl: "../image/image_vietnam/food8-1.jpg"
                    }
                ]
            },
            {
                name: "🌾 다낭",
                lat: 16.05706,
                lng: 108.20774,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 16.05706,
                        lng: 108.20774,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 16.05706,
                        lng: 108.20774,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            }
        ]
    },
    {
        name: "필리핀",
        cities: [
            {
                name: "🌊 세부",
                lat: 10.292420,
                lng: 123.905088,
                desc: "자연과 함께하는 특별한 여행지",
                sights: [
                	{
                        name: "가와산",
                        lat: 9.802940,
                        lng: 123.374814,
                        imageUrl: "../image/image_cebu/place1-1.jpg"
                    },
                    {
                    	name: "투말록 폭포",
                        lat: 9.485816,
                        lng: 123.369798,
                        imageUrl: "../image/image_cebu/place2-4.jpg"
                    },
                    {
                    	name: "오슬롭 (고래상어)",
                        lat: 9.515050,
                        lng: 123.430132,
                        imageUrl: "../image/image_cebu/place2-1.jpg"
                    },
                    {
                    	name: "아얄라 쇼핑몰",
                        lat: 10.317952,
                        lng: 123.904682,
                        imageUrl: "../image/image_cebu/place3-1.jpg"
                    },
                    {
                    	name: "시라오 플라워 가든",
                        lat: 10.406216,
                        lng: 123.866209,
                        imageUrl: "../image/image_cebu/place4-1.jpg"
                    },
                    {
                    	name: "산토니뇨 성당",
                        lat: 10.294108,
                        lng: 123.901591,
                        imageUrl: "../image/image_cebu/place5-1.jpg"
                    },
                    {
                    	name: "산 페드로 요새",
                        lat: 10.292420,
                        lng: 123.905088,
                        imageUrl: "../image/image_cebu/place5-2.jpg"
                    },
                    {
                    	name: "도교 사원",
                        lat: 10.334111,
                        lng: 123.887877,
                        imageUrl: "../image/image_cebu/place7-1.jpg"
                    },
                    {
                    	name: "레아신전",
                        lat: 10.36893,
                        lng: 123.87326,
                        imageUrl: "../image/image_cebu/place6-1.jpg"
                    }
                ],
                foods: [
                ]
            }
        ]
    },
    {
        name: "태국",
        cities: [
            {
                name: "🐘 방콕",
                lat: 13.75975,
                lng: 100.51580,
                desc: "다채로운 매력이 가득한 여행지",
                sights: [
                	{
                        name: "왓 아룬",
                        lat: 13.74501,
                        lng: 100.48901,
                        imageUrl: "../image/image_bangkok/place1-1.jpg"
                    },
                    {
                        name: "왓 포",
                        lat: 13.74640,
                        lng: 100.49286,
                        imageUrl: "../image/image_bangkok/place1-2.jpg"
                    },
                    {
                        name: "아이콘시암",
                        lat: 13.72662,
                        lng: 100.50993,
                        imageUrl: "../image/image_bangkok/place2-1.jpg"
                    },
                    {
                        name: "담넌사두억",
                        lat: 13.52018,
                        lng: 99.95855,
                        imageUrl: "../image/image_bangkok/place3-8.jpg"
                    },
                    {
                        name: "카오산로드",
                        lat: 13.75896,
                        lng: 100.49729,
                        imageUrl: "../image/image_bangkok/place5-1.jpg"
                    },
                    {
                        name: "티츄카",
                        lat: 13.72232,
                        lng: 100.58068,
                        imageUrl: "../image/image_bangkok/place6-1.jpg"
                    },
                    {
                        name: "짜뚜짝 시장",
                        lat: 13.79996,
                        lng: 100.55060,
                        imageUrl: "../image/image_bangkok/place7-1.jpg"
                    }
                ],
                foods: [
                    {
                    }
                ]
            }
        ]
    },
    {
        name: "말레이시아",
        cities: [
            {
                name: "🐒 쿠알라룸푸르",
                lat: 3.15757,
                lng: 101.71149,
                desc: "도시 풍경이 아름다운 쿠알라룸푸르",
                sights: [
                	{
                        name: "페트로나스 트윈타워",
                        lat: 3.15757,
                        lng: 101.71149,
                        imageUrl: "../image/image_malaysia/place1-1.jpg"
                    },
                    {
                        name: "KL타워",
                        lat: 3.15296,
                        lng: 101.70383,
                        imageUrl: "../image/image_malaysia/place2-1.jpg"
                    },
                    {
                        name: "선웨이 라군",
                        lat: 3.06977,
                        lng: 101.60677,
                        imageUrl: "../image/image_malaysia/place3-1.jpg"
                    },
                    {
                        name: "KLCC 아쿠아리움",
                        lat: 3.15356,
                        lng: 101.71321,
                        imageUrl: "../image/image_malaysia/place4-1.jpg"
                    },
                    {
                        name: "메르데카 광장",
                        lat: 3.14903,
                        lng: 101.69364,
                        imageUrl: "../image/image_malaysia/place5-1.jpg"
                    },
                    {
                        name: "파빌리온",
                        lat: 3.14900,
                        lng: 101.71338,
                        imageUrl: "../image/image_malaysia/place6-1.jpg"
                    },
                    {
                        name: "잘란알로 야시장",
                        lat: 3.14584,
                        lng: 101.70874,
                        imageUrl: "../image/image_malaysia/place8-2.jpg"
                    },
                    {
                        name: "바투동굴",
                        lat: 3.23796,
                        lng: 101.68406,
                        imageUrl: "../image/image_malaysia/place9-1.jpg"
                    },
                    {
                        name: "페탈링 야시장",
                        lat: 3.14441,
                        lng: 101.69760,
                        imageUrl: "../image/image_malaysia/place10-1.jpg"
                    },
                    {
                        name: "타만코넛 야시장",
                        lat: 3.08144,
                        lng: 101.73755,
                        imageUrl: "../image/image_malaysia/place11-1.jpg"
                    }
                ],
                foods: [
                    {
                    }
                ]
            }
        ]
    },
    {
        name: "라오스",
        cities: [
            {
                name: "🛕 방비엥",
                lat: 18.94830,
                lng: 102.44440,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 18.94830,
                        lng: 102.44440,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 18.94830,
                        lng: 102.44440,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            }
        ]
    },
    {
        name: "이집트",
        cities: [
            {
                name: "🐫 카이로",
                lat: 30.04758,
                lng: 31.23752,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 30.04758,
                        lng: 31.23752,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 30.04758,
                        lng: 31.23752,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            },
            {
                name: "🐫 룩소르",
                lat: 25.69059,
                lng: 32.64127,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 25.69059,
                        lng: 32.64127,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 25.69059,
                        lng: 32.64127,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            },
            {
                name: "🐫 아스완",
                lat: 24.09264,
                lng: 32.90594,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 24.09264,
                        lng: 32.90594,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 24.09264,
                        lng: 32.90594,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            }
        ]
    },
    {
        name: "그리스",
        cities: [
            {
                name: "🏛️ 아테네",
                lat: 37.98486,
                lng: 23.72838,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 37.98486,
                        lng: 23.72838,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 37.98486,
                        lng: 23.72838,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            },
            {
                name: "🏛️ 산토리니",
                lat: 36.39488,
                lng: 25.45907,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 36.39488,
                        lng: 25.45907,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 36.39488,
                        lng: 25.45907,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            }
        ]
    },
    {
        name: "이탈리아",
        cities: [
            {
                name: "🍝 로마",
                lat: 41.89529,
                lng: 12.48102,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 41.89529,
                        lng: 12.48102,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 41.89529,
                        lng: 12.48102,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            },
            {
                name: "🍝 베니스",
                lat: 45.43973,
                lng: 12.33099,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 45.43973,
                        lng: 12.33099,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 45.43973,
                        lng: 12.33099,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            },
            {
                name: "🍝 피사",
                lat: 43.71739,
                lng: 10.39023,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 43.71739,
                        lng: 10.39023,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 43.71739,
                        lng: 10.39023,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            }
        ]
    },
    {
        name: "독일",
        cities: [
            {
                name: "🍺 베를린",
                lat: 52.49833,
                lng: 13.35868,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 52.49833,
                        lng: 13.35868,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 52.49833,
                        lng: 13.35868,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            }
        ]
    },
    {
        name: "영국",
        cities: [
            {
                name: "🎩 런던",
                lat: 51.50938,
                lng: -0.10850,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 51.50938,
                        lng: -0.10850,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 51.50938,
                        lng: -0.10850,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            }
        ]
    },
    {
        name: "프랑스",
        cities: [
            {
                name: "🥖 파리",
                lat: 48.86416,
                lng: 2.30308,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 48.86416,
                        lng: 2.30308,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 48.86416,
                        lng: 2.30308,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            }
        ]
    },
    {
        name: "싱가포르",
        cities: [
            {
                name: "🦁 싱가포르",
                lat: 1.36478,
                lng: 103.81398,
                desc: "준비중",
                sights: [
                	{
                        name: "준비중",
                        lat: 1.36478,
                        lng: 103.81398,
                        imageUrl: "../image/travel_ready.png"
                    }
                ],
                foods: [
                    {
                    	name: "준비중",
                        lat: 1.36478,
                        lng: 103.81398,
                        imageUrl: "../image/travel_ready.png"
                    }
                ]
            }
        ]
    }

];


    // 마커 아이콘 정의 (생략)
    const redIcon = L.icon({
        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png',
        iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34],
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png', shadowSize: [41, 41]
    });
    const sightIcon = L.icon({
        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',
        iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34],
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png', shadowSize: [41, 41]
    });
    const foodIcon = L.icon({
        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-orange.png',
        iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34],
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png', shadowSize: [41, 41]
    });
    const cityMarkerIcon = L.icon({
        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png',
        iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34],
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png', shadowSize: [41, 41]
    });

    // 맵 초기화
    function initMap() {
    if (map) map.remove();
    const bounds = [
        [-90, -180],
        [90, 180]
    ];
    map = L.map('map', {
        maxBounds: bounds,
        maxBoundsViscosity: 0.8,
        minZoom: 3,
        maxZoom: 19,
        zoomControl: false // 이 부분을 추가하여 확대/축소 버튼을 제거합니다.
    }).setView([30, 120], 2);
    
    // 이전에 있던 L.control.zoom() 코드는 삭제하거나 주석 처리합니다.
    // L.control.zoom({ position: 'topright' }).addTo(map); 

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);
    const legend = L.control({ position: 'bottomright' });
    legend.onAdd = function (map) {
        const div = L.DomUtil.create('div', 'info legend');
        div.innerHTML = `<p><b>마커 정보</b></p><p><i style="background:#337ab7;"></i> 도시</p><p><i style="background:#5cb85c;"></i> 관광지</p><p><i style="background:#f0ad4e;"></i> 맛집</p>`;
        return div;
    };
    legend.addTo(map);
}
    
    function resetMapAndUI() {
        allCityMarkers.forEach(marker => map.removeLayer(marker));
        allCityMarkers = [];
        currentDetailMarkers.forEach(marker => map.removeLayer(marker));
        currentDetailMarkers = [];
        selectedCityMarker = null;
        selectedDetailMarker = null;
        selectedDetailListItem = null;
        createAllCityMarkers();
    }
    
    function createAllCityMarkers() {
        data.forEach(country => {
            country.cities.forEach(city => {
                const marker = L.marker([city.lat, city.lng], { icon: cityMarkerIcon }).addTo(map);
                marker.bindPopup(city.name);
                marker.on('click', () => {
                    if (window.innerWidth <= 768) {
                        currentCity = city;
                        showDetails(city);
                        mobileControls.classList.add('open');
                    } else {
                        showCityInfo(city);
                    }
                    map.setView([city.lat, city.lng], 10);
                });
                allCityMarkers.push(marker);
            });
        });
    }

    // 데스크톱 UI 로직
    function setupDesktopUI() {
        mobileControls.style.display = 'none';
        mobileToggleBtn.style.display = 'none';
        sidebar.style.display = 'flex';
        openSidebar();
        createCountryList();
        resetMapAndUI();
    }
    function createCountryList() {
        countryListDiv.innerHTML = "";
        data.forEach(country => {
            const countryBtn = document.createElement("button");
            countryBtn.className = "country-btn title-btn";
            countryBtn.textContent = country.name;
            countryListDiv.appendChild(countryBtn);
            const cityList = document.createElement("div");
            cityList.className = "city-list";
            country.cities.forEach(city => {
                const cityBtn = document.createElement("button");
                cityBtn.className = "city-btn";
                cityBtn.textContent = city.name;
                cityList.appendChild(cityBtn);
                cityBtn.addEventListener("click", () => {
                    showCityInfo(city);
                    
                    // panTo 대신 flyTo를 사용하고, zoom 레벨을 10으로 지정합니다.
                    const panOffset = [sidebar.offsetWidth / 2, 0];
                    map.flyTo([city.lat, city.lng], 10, {
                        padding: panOffset,
                    });
                });
            });
            countryListDiv.appendChild(cityList);
            countryBtn.addEventListener("click", () => {
                const isOpen = cityList.style.maxHeight !== "0px" && cityList.style.maxHeight !== "";
                document.querySelectorAll(".city-list").forEach(cl => cl.style.maxHeight = "0");
                if (!isOpen) { cityList.style.maxHeight = cityList.scrollHeight + "px"; }
                description.innerHTML = "";
                countryListDiv.classList.remove("hidden");
                showCountryListBtn.classList.add("hidden");
                resetMapAndUI();
            });
        });
    }
    function showCityInfo(city) {
        currentDetailMarkers.forEach(marker => map.removeLayer(marker));
        currentDetailMarkers = [];
        selectedDetailMarker = null;
        selectedDetailListItem = null;
        const cityMarker = allCityMarkers.find(marker => {
            const latLng = marker.getLatLng();
            return latLng.lat === city.lat && latLng.lng === city.lng;
        });
        if (selectedCityMarker) { selectedCityMarker.setIcon(cityMarkerIcon); }
        if (cityMarker) {
            cityMarker.setIcon(redIcon);
            selectedCityMarker = cityMarker;
        }
        description.innerHTML = "";
        description.classList.remove("hidden");
        countryListDiv.classList.add("hidden");
        showCountryListBtn.classList.remove("hidden");
        const cityTitle = document.createElement("h2");
        cityTitle.textContent = city.name;
        description.appendChild(cityTitle);
        const cityDesc = document.createElement("p");
        cityDesc.textContent = city.desc;
        description.appendChild(cityDesc);
        const sightsTitle = document.createElement("h3");
        sightsTitle.textContent = "🗼 관광지";
        description.appendChild(sightsTitle);
        const sightsList = document.createElement("ul");
        sightsList.id = "sights-list";
        description.appendChild(sightsList);
        city.sights.forEach(item => {
            const listItem = document.createElement("li");
            listItem.textContent = item.name;
            sightsList.appendChild(listItem);
            const marker = L.marker([item.lat, item.lng], { icon: sightIcon }).addTo(map);
            const popupContent = `<div style="text-align: center;"><h4>${item.name}</h4><img src="${item.imageUrl}" alt="${item.name}" style="width:150px; height:auto; border-radius: 5px;"></div>`;
            marker.bindPopup(popupContent);
            marker.originalIcon = sightIcon;
            currentDetailMarkers.push(marker);
            const onClick = () => {
                if (selectedDetailMarker) { selectedDetailMarker.setIcon(selectedDetailMarker.originalIcon); }
                if (selectedDetailListItem) { selectedDetailListItem.classList.remove("active"); }
                marker.setIcon(redIcon);
                marker.openPopup();
                listItem.classList.add("active");
                selectedDetailMarker = marker;
                selectedDetailListItem = listItem;
                
                const panOffset = [sidebar.offsetWidth / 2, 0];
                map.flyTo([item.lat, item.lng], 15, {
                    padding: panOffset,
                });
            };
            listItem.addEventListener("click", onClick);
            marker.on("click", onClick);
        });
        const foodsTitle = document.createElement("h3");
        foodsTitle.textContent = "🍽️ 맛집";
        description.appendChild(foodsTitle);
        const foodsList = document.createElement("ul");
        foodsList.id = "foods-list";
        description.appendChild(foodsList);
        city.foods.forEach(item => {
            const listItem = document.createElement("li");
            listItem.textContent = item.name;
            foodsList.appendChild(listItem);
            const marker = L.marker([item.lat, item.lng], { icon: foodIcon }).addTo(map);
            const popupContent = `<div style="text-align: center;"><h4>${item.name}</h4><img src="${item.imageUrl}" alt="${item.name}" style="width:150px; height:auto; border-radius: 5px;"></div>`;
            marker.bindPopup(popupContent);
            marker.originalIcon = foodIcon;
            currentDetailMarkers.push(marker);
            const onClick = () => {
                if (selectedDetailMarker) { selectedDetailMarker.setIcon(selectedDetailMarker.originalIcon); }
                if (selectedDetailListItem) { selectedDetailListItem.classList.remove("active"); }
                marker.setIcon(redIcon);
                marker.openPopup();
                listItem.classList.add("active");
                selectedDetailMarker = marker;
                selectedDetailListItem = listItem;
                
                const panOffset = [sidebar.offsetWidth / 2, 0];
                map.flyTo([item.lat, item.lng], 15, {
                    padding: panOffset,
                });
            };
            listItem.addEventListener("click", onClick);
            marker.on("click", onClick);
        });
    }

    // 모바일 UI 로직
    function setupMobileUI() {
        sidebar.style.display = 'none';
        mobileControls.style.display = 'flex';
        mobileControls.classList.add('closed');
        mobileToggleBtn.style.display = 'flex';
        createCountrySlider();
        resetMapAndUI();
    }
    
    function toggleMobileControls() {
        const isOpen = mobileControls.classList.contains('open');
        if (isOpen) {
            mobileControls.classList.remove('open');
            mobileControls.classList.add('closed');
            mobileToggleBtn.textContent = '☰';
        } else {
            mobileControls.classList.remove('closed');
            mobileControls.classList.add('open');
            mobileToggleBtn.textContent = '✖';
        }
    }
    
    function createCountrySlider() {
        currentView = 'countries';
        infoPanel.style.display = 'none';
        backButton.classList.add('hidden');
        countrySlider.innerHTML = "";
        countrySlider.style.display = 'flex';
        
        data.forEach(country => {
            const countryBtn = document.createElement("button");
            countryBtn.className = "country-btn";
            countryBtn.textContent = country.name;
            countrySlider.appendChild(countryBtn);
            countryBtn.addEventListener('click', () => {
                currentCountry = country;
                showCities(country);
            });
        });
    }
    function showCities(country) {
        currentView = 'cities';
        countrySlider.style.display = 'none';
        infoPanel.style.display = 'block';
        backButton.classList.remove('hidden');
        contentList.innerHTML = `<h4 class="title">${country.name}</h4>`;
        
        country.cities.forEach(city => {
            const listItem = document.createElement("li");
            listItem.textContent = city.name;
            contentList.appendChild(listItem);
            listItem.addEventListener('click', () => {
                currentCity = city;
                showDetails(city);
                map.setView([city.lat, city.lng], 10);
            });
        });
        
        currentDetailMarkers.forEach(marker => map.removeLayer(marker));
        currentDetailMarkers = [];

        allCityMarkers.forEach(marker => map.removeLayer(marker));
        allCityMarkers = [];
        country.cities.forEach(city => {
            const marker = L.marker([city.lat, city.lng], { icon: cityMarkerIcon }).addTo(map);
            marker.on('click', () => {
                currentCity = city;
                showDetails(city);
                map.setView([city.lat, city.lng], 10);
            });
            allCityMarkers.push(marker);
        });
    }
 // `showDetails` 함수 수정
    function showDetails(city) {
        currentView = 'details';
        backButton.classList.remove('hidden');
        contentList.innerHTML = `<h4 class="title">${city.name}</h4><p>${city.desc}</p>`;
        
        // 모바일 UI에서는 도시 마커를 지우는 대신, 기존 마커를 재활용하여 아이콘을 변경합니다.
        allCityMarkers.forEach(marker => map.removeLayer(marker));
        allCityMarkers = [];
        
        const allItems = [...city.sights.map(item => ({ ...item, type: 'sight' })), ...city.foods.map(item => ({ ...item, type: 'food' }))];
        
        currentDetailMarkers.forEach(marker => map.removeLayer(marker));
        currentDetailMarkers = [];
        
        // 도시 마커 아이콘 변경 로직은 제거하고, 세부 정보 마커만 표시
        
        allItems.forEach(item => {
            const listItem = document.createElement("li");
            listItem.innerHTML = `<img src="${item.imageUrl || './image/placeholder.png'}" alt="${item.name}" /><span>${item.name}</span>`;
            if (item.type === 'sight') {
                listItem.classList.add('sight');
            } else if (item.type === 'food') {
                listItem.classList.add('food');
            }
		
		contentList.appendChild(listItem);
            
            const icon = item.type === 'sight' ? sightIcon : foodIcon;
            const marker = L.marker([item.lat, item.lng], { icon: icon }).addTo(map);

            // 마커에 이미지와 정보를 담은 팝업을 바인딩합니다.
            const popupContent = `
                <div style="text-align: center;">
                    <h4>${item.name}</h4>
                    <img src="${item.imageUrl}" alt="${item.name}" style="width: 150px; height: auto; border-radius: 5px;">
                </div>
            `;
            marker.bindPopup(popupContent);
            
            marker.originalIcon = icon;
            currentDetailMarkers.push(marker);
            
            const onClick = () => {
                if (selectedDetailMarker) { selectedDetailMarker.setIcon(selectedDetailMarker.originalIcon); }
                if (selectedDetailListItem) { selectedDetailListItem.classList.remove("active"); }
                
                marker.setIcon(redIcon);
                marker.openPopup();
                listItem.classList.add("active");
                
                selectedDetailMarker = marker;
                selectedDetailListItem = listItem;
                
                map.setView([item.lat, item.lng], 15);
            };
            
            listItem.addEventListener("click", onClick);
            marker.on("click", onClick);
        });
    }

    // 데스크톱 사이드바 토글 함수
    function closeSidebar() {
	    sidebar.classList.add("closed");
	    mapDiv.classList.add("expanded");
	    openBtn.style.display = 'block';
	    toggleBtn.style.display = 'none';
	}
	function openSidebar() {
	    sidebar.classList.remove("closed");
	    mapDiv.classList.remove("expanded");
	    openBtn.style.display = 'none';
	    toggleBtn.style.display = 'block';
	}
    
    // 화면 크기 변경 감지 및 UI 초기화
    function handleResize() {
        if (window.innerWidth <= 768) {
            setupMobileUI();
        } else {
            setupDesktopUI();
        }
    }

    // 이벤트 리스너
    toggleBtn.addEventListener("click", closeSidebar);
    openBtn.addEventListener("click", openSidebar);
    showCountryListBtn.addEventListener("click", () => {
        description.classList.add("hidden");
        countryListDiv.classList.remove("hidden");
        showCountryListBtn.classList.add("hidden");
        resetMapAndUI();
        if (selectedCityMarker) {
            selectedCityMarker.setIcon(cityMarkerIcon);
            selectedCityMarker = null;
        }
    });
    backButton.addEventListener("click", () => {
        if (currentView === 'cities') {
            createCountrySlider();
        } else if (currentView === 'details') {
            showCities(currentCountry);
        }
    });
    
    mobileToggleBtn.addEventListener("click", toggleMobileControls);

    // 초기 실행
    initMap();
    handleResize();
    window.addEventListener('resize', handleResize);
</script>
</body>
</html>
